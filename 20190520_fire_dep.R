library(ggplot2)
month <- c("1ŒŽ","2ŒŽ","3ŒŽ","4ŒŽ","5ŒŽ","6ŒŽ","7ŒŽ","8ŒŽ","9ŒŽ","10ŒŽ","11ŒŽ","12ŒŽ")
fire <- c(84,81,91,78,78,77,69,68,65,53,85,90)
order <- seq(1:12)
data <- data.frame(month,fire,order)
data
ggplot(data= data, aes(x=reorder(month,order), y=fire))+
geom_bar(stat="identity")


setwd("C:/Users/torug/Desktop/forR")
getwd()
wind <- read.csv("weather_data.csv", skip=5)

caution <- c(
0,0,0,0,0,1,1,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,0,0,1,
0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,
1,0,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,0,
0,1,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,0,1,1,0,0,1,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,0,
0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,
0,1,0,0,0,1,0,1,0,0,1,1,1,1,1,0,1,1,1,1,0,1,1,0,0,1,0,1,1,1,0
)

fire <- c(
2,2,1,3,1,2,4,2,2,6,3,7,4,2,2,3,3,3,1,4,0,3,3,5,0,3,2,1,3,2,5,
5,1,3,1,1,2,4,1,3,3,2,4,3,2,2,0,3,6,1,3,4,5,0,3,4,7,5,3,
3,0,1,5,5,2,4,1,1,3,3,5,1,2,4,3,2,6,7,5,1,3,1,4,1,2,3,2,6,3,2,
1,5,3,3,1,1,1,6,0,2,1,1,1,3,0,0,1,2,2,0,2,5,3,4,3,2,9,7,3,6,
5,1,3,4,3,0,3,2,2,2,2,3,1,1,4,1,4,3,5,1,1,2,4,5,2,1,4,4,2,1,2,
2,1,3,3,4,3,0,3,2,0,1,5,4,2,3,6,2,4,5,2,6,2,5,0,2,2,1,2,0,2,
3,7,4,2,0,3,2,1,3,3,2,3,1,0,1,2,5,3,0,2,2,1,2,6,2,1,1,3,0,2,2,
3,3,2,3,1,2,3,0,1,2,3,3,1,1,5,3,2,1,6,2,1,0,1,4,2,2,2,0,2,2,5,
3,3,5,2,0,2,0,1,2,4,5,0,3,0,2,2,3,3,3,1,2,1,3,4,3,1,3,1,1,2,
2,1,0,3,4,2,2,1,1,4,1,1,1,3,1,3,2,0,1,2,0,1,3,1,4,0,1,4,1,1,2,
4,7,3,3,7,6,2,3,3,6,1,0,2,1,1,2,3,1,4,4,8,0,2,1,0,3,2,3,0,3,
2,4,1,4,4,5,1,5,4,1,2,1,3,3,5,1,6,2,2,2,0,5,4,2,3,6,0,4,2,5,0
)


emergency <- c(
654,668,756,687,664,701,684,599,713,725,609,601,574,652,626,697,638,683,658,637,631,638,674,656,630,703,636,728,679,649,625,
670,629,621,657,645,692,645,601,597,684,696,656,655,635,651,656,651,660,626,646,579,664,602,608,677,595,615,678,
632,609,600,639,664,639,615,584,604,569,636,577,631,618,601,570,596,681,632,621,598,556,610,562,621,618,558,600,584,587,601,
663,665,613,674,540,586,592,650,606,625,589,517,551,676,639,660,620,570,548,544,600,630,559,552,585,537,536,677,707,640,
644,642,666,635,647,663,661,681,522,597,620,603,591,636,574,573,540,544,537,598,621,623,516,584,568,560,612,563,582,607,606,
644,639,631,673,640,564,546,619,626,660,530,609,553,538,618,652,634,652,676,559,511,606,610,697,608,625,495,584,616,661,
726,694,687,639,594,595,590,664,613,616,670,693,614,708,723,735,658,631,674,681,695,700,708,658,609,678,673,659,666,623,764,
658,693,660,663,692,690,586,587,638,688,705,676,625,648,637,630,677,665,634,665,621,603,676,656,627,637,605,619,627,583,606,
662,655,602,569,548,572,604,578,681,605,661,537,528,612,586,607,582,589,617,549,605,538,621,589,586,581,496,554,693,638,
662,616,570,571,575,568,644,640,619,656,560,525,638,590,595,637,571,589,550,600,601,625,701,608,602,601,625,624,597,641,698,
649,688,682,615,602,671,615,562,570,639,608,587,612,569,536,587,591,601,590,613,545,656,622,665,599,670,590,607,553,646,
647,644,582,615,614,596,595,629,675,660,625,611,632,636,750,708,711,689,665,636,682,730,779,734,691,745,688,751,743,805,724
)
length(emergency)
nrow(wind)
length(caution)
data[1,]
str(data)
names(wind)
data <- cbind(wind,caution,fire,emergency)
names(data)[which(names(data)=="X")] <- "date"
data$date <- as.Date(data$date)
names(data)[which(names(data)=="X.1")] <- "wind"
names(data)[which(names(data)=="X.2")] <- "temperature_ave"
names(data)[which(names(data)=="X.3")] <- "temperature_max"

ggplot(data=data,aes(x=emergency))+
geom_histogram()

ggplot(data=data,aes(x=date,y=emergency))+
geom_line()

ggplot(data=data,aes(x=emergency,y=temperature_max))+
geom_point()

ggplot(data=data,aes(x=wind,y=fire,colour=caution))+
geom_jitter()+
geom_smooth(method="lm")

ggplot(data=data,aes(x=fire,y=wind,colour=caution))+
geom_jitter()+
geom_smooth(method="lm")


sum(caution)

lm(data$fire~data$wind)
lm(data$emergency~data$temperature_max)
lm(data$emergency~data$temperature_ave)
cor(data$emergency,data$temperature_max)

library(sf)
shape <- read_sf("h27_did_27.shp")
head(shape)